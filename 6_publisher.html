<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第VI部〜秀丸エディタ拡張モジュール　秀丸パブリッシャー</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <link rel="stylesheet" href="base.css" />
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" alt="Hidemaru Q and A" width="88" height="32" /></a></p>
<h1 id="TOP">第VI部〜秀丸エディタ拡張モジュール<br>　秀丸パブリッシャー</h1>
<hr />
<h2 id="INDEX">●秀丸パブリッシャーとは?</h2>
<p>　秀丸エディタにもデフォルトで印刷機能がついていますが、あまり機能は多くありません。</p>
<p>秀丸パブリッシャーを使う事で、</p>
<ul>
<li>印刷プレビュー</li>
<li>カラー印刷</li>
<li>秀丸エディタ本体での文字修飾をそのまま印刷</li>
</ul>
<p>が可能になります。</p>
<p>秀丸パブリッシャーは、</p>
<ul>
<li>「Visual Basic版」</li>
<li>.NET Frameworkで作成した「64bit版」</li>
</ul>
<p>の2種類が存在します。</p>
<p><strong>「64bit版」とありますが 32bit版秀丸エディタ/32bit OS でも使用可能で、</strong> <span class="font_red_bold">Windows Vista 以降は、32bit/64bit 秀丸エディタを問わずに、.NET Framework で作成した「64bit版」を使用する事を推奨しています。</span></p>
<p>以降の説明は、「<span class="attention_red">64bit版</span>」を前提にしています。</p>
<ul>
<li><a href="#INSTALL">【1】ダウンロード、インストールと秀丸エディタ本体の設定</a></li>
<li><a href="#PRINTOUT">【2】印刷するには</a></li>
<li><a href="#TEMPLATE">【3】印刷フォーマットを指定して印刷したい</a></li>
<li><a href="#WARNING">【4】テンプレートの注意点</a></li>
</ul>
<!-- #3 -->
<div class="marginleft">
<h3 id="INSTALL">【1】ダウンロード、インストールと秀丸エディタ本体の設定</h3>
<p>秀丸パブリッシャーは、以下の場所から入手可能です。</p>
<ul>
<li><p><a href="https://hide.maruo.co.jp/" class="externallink" target="_blank">秀まるおのホームページ</a> - <a href="https://hide.maruo.co.jp/software/index.html" class="externallink" target="_blank">ソフトウェア</a> - <a href="https://hide.maruo.co.jp/software/hmpv.html" class="externallink" target="_blank">秀丸パブリッシャー</a></p>
<p>2019/03/07 現在、以下のバージョンが公開されています。</p>
<ul>
<li>64bit版(<span class="attention_red">32bit版秀丸エディタ/32bit OS でも使用可</span>)は、Ver.4.24</li>
<li>32bit版(VisualBasic 版)は、Ver.4.16b</li>
</ul></li>
</ul>
<p>秀丸パブリッシャー自体は、フリーソフトウェアです。秀丸エディタ Ver.8.00 以上で使用する事が推奨されています。</p>
<p>ダウンロードしたファイルを実行するとインストール先を聞かれます。</p>
<p><img src="6_publisher_01.png" alt="インストール先の設定" width="446" height="243" /><br />
</p>
<p>インストールが完了すると、秀丸エディタ本体の設定を変えるようメッセージが表示されるので、 「<span class="env">動作環境</span>」から設定の変更を行いましょう。</p>
<p><img src="6_publisher_02.png" alt="最終メッセージ" width="482" height="203" /><br />
</p>
<p><img src="6_publisher_03.png" alt="秀丸エディタ本体側の印刷設定" width="605" height="191" /><br />
</p>
<h3 id="PRINTOUT">【2】印刷するには</h3>
<p>設定が多いですが、普通に印刷するだけなら、以下の2箇所を設定・確認後、 印刷範囲、印刷部数を確認し、「印刷」ボタンを押すだけです。<br />
(デフォルトでテンプレートは「_標準印刷」が選択されています。)</p>
<ul>
<li><p>「設定の一覧」にある「プリンタ/用紙」を選択し、使用するプリンターと用紙サイズを確認・設定。</p>
<p><img src="6_publisher_04.png" alt="プリンター/用紙" width="602" height="425" /><br />
</p></li>
<li><p>「設定の一覧」にある「本文BOX」を選択し、余白やフォント、フォントサイズ、カラー印刷など設定。<br />
行番号や、ファイル名の印刷なども「本文BOX」の設定で可能です。</p>
<p><img src="6_publisher_05.png" alt="本文BOX" width="577" height="261" /><br />
</p>
<ul>
<li>「カラー印刷」にチェックを入れると、「フォント修飾再現」は操作できなくなります。 (強制的にONになり、OFFにできない)</li>
<li>「背景色は白にする」は、カラー印刷じゃない場合も設定できますが、「カラー印刷」が有効でないと意味がないです。</li>
<li>「フォント修飾再現」は、「ファイルタイプ別設定-デザイン」で設定したスタイルを印刷時にも適用するかどうかです。</li>
<li>「編集記号の印刷」は、通常印刷されない、タブ文字、改行文字、全角空白、半角空白を印刷します。<br />
実際に印刷されるのは、「<span class="filetype">ファイルタイプ別の設定</span>」で表示するように設定してある「編集記号」だけです。 つまり、印刷するファイルの設定に影響されます。画面に表示されない編集記号は、チェックを入れても印刷されません。</li>
</ul></li>
</ul>
<p><span class="attention_red">注意</span></p>
<ul>
<li><p>「余白」等で数値を入力可能な箇所がありますが、キーボードから直接数値を入力して「Enter」を押すと、 印刷が始まってしまいます。(IMEがOFFの場合。)</p>
<p>これは、デフォルトのボタンが「印刷」に設定されているからです。 項目を移動するつもりで「Enter」を押してしまうと、印刷が始まってしまうので注意してください。</p></li>
</ul>
<h3 id="TEMPLATE">【3】印刷フォーマットを指定して印刷したい</h3>
<p>ファイル名の表示や、ページ番号の印刷も「本文BOX」の設定で可能ですが、</p>
<ul>
<li>本文とは別のフォントにしたい、</li>
<li>ページ番号の印字方法を変えたい</li>
<li>ページ番号を印刷する場所を変えたい</li>
</ul>
<p>等の場合は、テンプレートを編集する事で可能になります。</p>
<!-- #4 -->
<div class="marginleft">
<h4 id="TEMPLATE-1">テンプレートの簡単な説明</h4>
<ul>
<li><p>秀丸パブリッシャーで印刷を行うには、「テンプレート」を作成し指定する必要があります。 Wordなど、ワープロソフトと違い、印刷対象のファイル内に印刷設定を保存する事ができないため、 印刷するテキストと、印刷設定を記録する「テンプレート」は別のファイルになります。</p>
<p>つまり指定されたテンプレートに合わせ、本文を印刷する事になります。 テンプレートは「_標準印刷」の他、サンプルがいくつか添付されています。</p></li>
<li><p>「テンプレート」には、用紙内に「BOX」という印刷エリアを配置し、設定する必要があります。</p>
<p>「BOX」は通常の「BOX」と「本文BOX」の2種類あり、配置は「レイアウト編集」で行います。</p></li>
<li><p>「テンプレート」には、「本文BOX」がデフォルトで配置され、削除はできません。 「本文BOX」は印刷を実行するファイルの内容が挿入される場所なので、必ず1個必要になります。 (新規でテンプレートを作成すると、「本文BOX」がデフォルトで配置されます。)</p></li>
<li><p>通常の「BOX」には、記述した内容が、そのまま表示/印刷されます。 ワープロでいうところの、ヘッダー/フッターのような使い方になります。 ページ番号や、ファイル名、フルパスなどが設定できます。</p></li>
</ul>
<h4 id="TEMPLATE-2">テンプレートの編集</h4>
<p>では、テンプレートを実際に作成・編集してみましょう。</p>
<p>テンプレート名が表示されている箇所の横にある、"…" ボタンを押して、テンプレートの一覧画面を表示させます。</p>
<p><img src="6_publisher_06.png" alt="テンプレート一覧表示ボタン" width="602" height="99" /><br />
</p>
<p>この画面で、テンプレート新規作成、コピー、削除等が可能です。 今回は<strong>"_標準印刷"</strong>をコピーして、<span class="attention_red">"テスト用"</span>という名前でテスト用のテンプレートを作り、編集していきます。</p>
<p><img src="6_publisher_07.png" alt="テンプレート一覧ダイアログ" width="406" height="179" /><br />
</p>
<p>テンプレートは、用紙の上から順番に</p>
<ul>
<li>ファイル名(フルパス)</li>
<li>ファイルの作成日時</li>
<li>印刷日時</li>
<li>本文</li>
<li>ページ番号</li>
</ul>
<p>という構成で作成します。</p>
<p>まずは、用紙と、余白を設定してください。 (「設定の一覧」にある「本文BOX」の余白の設定とそこに表示されている、高さと幅を記録しておいてください。)</p>
<p>「レイアウト編集」ボタンを押すと、編集画面が開きます。 初期状態では、マージンいっぱいまで、本文BOX が配置されているだけです。</p>
<ol type="1">
<li><p>他のBOXを配置するために、本文ボックスの高さを適当に変えて、BOXを配置する場所を作ります。 BOXは、重ねる事が可能なので、ずらさないと印刷時に重なってしまいます。<br />
<img src="6_publisher_08.png" alt="レイアウト-本文BOX" width="442" height="327" /><br />
</p></li>
<li><p>ファイル名表示用のBOXを追加します。 編集画面のツールバー、または余白部分の右クリックメニューから「BOXの新規追加」を選択し、 「BOXを新規に追加する」を選択し「OK」を押すと、レイアウト編集画面にBOXが追加されます。</p>
<p><img src="6_publisher_09.png" alt="レイアウト-BOXの追加" width="442" height="317" /><br />
</p>
<p><img src="6_publisher_10.png" alt="レイアウト-BOXの追加ダイアログ" width="208" height="120" /><br />
</p>
<p>BOXを選択しダブルクリックすると、BOXのプロパティが開き、フォントや表示する内容などを設定する事ができます。 プロパティ画面の設定に関しての詳細は「ヘルプ」を参照の事。</p>
<p>今回はファイル名を表示するので、「テキスト」の「属性」を「ファイル名(フルパス)」にし、 フォントやサイズ、スタイルは、好みにあわせて設定を行います。</p>
<p><img src="6_publisher_11.png" alt="レイアウト-BOXのプロパティ" width="636" height="719" /><br />
</p>
<p>設定後、「適用」ボタンを押すと、設定内容に合わせBOXの表示が変わるので、設定内容の確認ができます。</p>
<p>BOXの位置ですが、「サイズ」で値の指定が可能ですが、マウスを使用し、BOX自体を動かす事で配置を決める事ができます。 しっかりと指定したい場合は、事前にメモしておいた、余白、高さ、幅から計算して入力してください。</p></li>
<li><p>同様に、ファイルの作成日時、印刷日時、ページ番号用のBOXを追加していきます。</p>
<p>「テキスト」の「属性」をそれぞれ「タイムスタンプ」、「時間」、「ページ番号」に設定してください。</p></li>
<li><p>ここでレイアウト編集画面を閉じ、プレビューで確認を行います。</p>
<p>"ファイルの作成日時"と"印刷日時"を追加しましたが、ぱっと見でどちらが何の日時なのかわかりません。<br />
<img src="6_publisher_12.png" alt="プレビュー1" width="426" height="303" /><br />
</p>
<p>そこで、各日時の前に"<strong>ファイル作成日：</strong>"と"<strong>印刷日時：</strong>"という文字を<span class="attention_red">追加</span>します。<br />
<img src="6_publisher_13.png" alt="プレビュー2" width="546" height="303" /><br />
</p>
<p>追加する方法は、いくつかあります。</p>
<ul>
<li><p>"ファイルの作成日時"と"印刷日時"を表示しているBOXの前に、新たにBOXを追加して、各文字を入力する。</p></li>
<li><p>BOXのプロパティにある、テキストの「属性」はそのままで、「書式」を変更する。</p>
<pre><code>変更前の属性　YYYY年MM月DD日（W曜日）hh:mm:ss
変更後の属性　ファイル作成日：YYYY年MM月DD日（W曜日）hh:mm:ss</code></pre></li>
<li><p>BOXのプロパティにある、テキストの「属性」を「通常テキスト」にし、「テキスト」を変更する。</p>
<pre><code>変更前のテキスト　
変更後のテキスト　ファイル作成日：%timestamp%</code></pre>
<p>こちらの方法でも、デフォルトの書式が使われるようです。</p>
<p>BOXテキストの内容ですが、属性を設定しても、実際は以下のテキストが設定されます。<br />
(レイアウト編集画面ではわかりませんが、メイン画面-設定の一覧にあるBOXの設定画面で確認できます。)</p>
<p><img src="6_publisher_14.png" alt="設定-BOX1" width="586" height="116" /><br />
</p>
<div class="table_border">
<table>
<caption>属性名とテキスト</caption>
<thead>
<tr class="header">
<th style="text-align: left;">属性名</th>
<th style="text-align: left;">設定されるテキスト</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ファイル名（フルパス）</td>
<td style="text-align: left;">filename</td>
</tr>
<tr class="even">
<td style="text-align: left;">ファイル名</td>
<td style="text-align: left;">basename</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ディレクトリ名</td>
<td style="text-align: left;">directory</td>
</tr>
<tr class="even">
<td style="text-align: left;">ページ番号</td>
<td style="text-align: left;">pagenum</td>
</tr>
<tr class="odd">
<td style="text-align: left;">時間</td>
<td style="text-align: left;">date</td>
</tr>
<tr class="even">
<td style="text-align: left;">タイムスタンプ</td>
<td style="text-align: left;">timestamp</td>
</tr>
</tbody>
</table>
</div>
<p>その為、テキストの内容が、上記属性と一致してしまうと、その内容が表示されてしまいます。 (大文字小文字は無視、前後の空白も無視されるので、FileName 等でも一致してしまいます。)</p>
<p>逆に、テキスト中に属性の内容を取り込みたい場合は、%で囲ってください。(例:%filename%)</p></li>
</ul></li>
<li><p>後は実際に印刷して結果を確認し、 修正箇所があれば、再度テンプレートを修正してください。</p></li>
</ol>
<p>以上、簡単ですがテンプレート作成例です。 今回、本文BOXは1個でしたが、2個にして、冊子印刷も可能です。 詳細は秀丸パブリッシャーのヘルプを参照してください。</p>
</div>
<h3 id="WARNING">【4】テンプレートの注意点</h3>
<ul>
<li><p>テンプレートファイルですが、一時的な設定のつもりで設定を変えてしまうと、 その設定が保存されてしまいます。<br />
(例えば、フォントの設定等)</p>
<pre><code>印刷 → 印刷ダイアログ開く → 一時的なつもりでフォントを変更  → 印刷実行</code></pre>
<p>という作業を行うと、変更内容はテンプレートに保存されます。</p>
<p>設定変更を行っても、テンプレートに保存しないようにするには、 「テンプレート上書き禁止」をチェックしてください。</p>
<p><img src="6_publisher_15.png" alt="テンプレート上書き禁止" width="602" height="64" /><br />
</p></li>
<li><p>現状、BOXではUnicode特有の文字を指定できません。Shift_JISに含まれる文字のみ表示可能です。</p>
<p>ただし、「属性」をファイル名にした場合(フルパスも含む)は、 ファイル名にUnicode特有の文字があっても正常に表示されます。</p></li>
<li><p>テンプレートの保存場所は、「秀丸パブリッシャー」のダイアログから確認できます。</p>
<p>「印刷」を実行し、秀丸パブリッシャーのダイアログを表示させます。 ダイアログ左上のアイコン部分をクリックすると、メニューが表示されるので「設定」を選択します。</p>
<p><img src="6_publisher_16.png" alt="設定メニュー" width="408" height="202" /><br />
</p>
<p>「印刷テンプレートの設定」ダイアログが表示され、テンプレートを保存してあるフォルダが表示されます。</p>
<p><img src="6_publisher_17.png" alt="印刷テンプレートの設定ダイアログ" width="396" height="263" /><br />
</p>
<p>テンプレートをバックアップする場合は、このフォルダを保存するようにしてください。</p></li>
</ul>
</div>
<hr />
<p><a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja">
<head>
  <meta charset="Shift_JIS" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>第II部〜知っていると便利な秀丸の機能　複数選択</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      .smallcaps{font-variant: small-caps;}
      .line-block{white-space: pre-line;}
      .column{display: inline-block;}
  </style>
  <link rel="stylesheet" href="base.css">
  <!--[if lt IE 9]>
    <script src="./html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><a href="hmindex0.html"><img src="hide_by2.png" alt="Hidemaru Q and A" width="88" height="32" /></a></p>
<h1 id="TOP">第II部〜知っていると便利な秀丸の機能<br />　複数選択</h1>
<hr />
<h2 id="MULTISELECT">●複数選択</h2>
<p>秀丸エディタ Ver.8.40以降では、「<strong>複数選択</strong>」が可能です。</p>
<p>エディタ画面上で、複数個所の選択を行い、同時に編集および各種変換、削除、コピーする事が可能です</p>
<ul>
<li><a href="#EXPLANATION">解説</a></li>
<li><a href="#SUPPLEMENTATION">補足</a></li>
</ul>
<!-- h3 -->
<div class="marginleft">
<h3 id="EXPLANATION">[解説]</h3>
<p>複数選択を行う方法は、いくつかの方法があります。</p>
<ul>
<li><p>マウスで複数選択を使う方法</p>
<ol type="1">
<li>最初は通常通りドラッグを行い範囲選択します。</li>
<li>以降は、[Ctrl]+[Alt]キーを押しながら(デフォルトの設定、変更は可能)、ドラッグを行うと複数選択になります。</li>
</ol>
<p>マウスの場合は、複数選択箇所の修正ができないので、間違った場合は一度すべての選択を解除する必要があります。</p></li>
<li><p>キーボードで複数選択を行う方法</p>
<p>マウスに比べると、手順が複雑になりますが、選択の修正はやりやすいかもしれません。</p>
<ol type="1">
<li>範囲選択を行い、「複数選択予約」を行う。</li>
<li>以降も同様に、「範囲選択」→「複数選択予約」を繰り返す。</li>
<li>「複数選択予約を選択」を行うと、予約した箇所が複数選択状態になる。</li>
</ol>
<ul>
<li>「複数選択予約」を行った状態で[ESC]キーを押すと、全ての「複数選択予約」が解除されます。</li>
<li>「複数選択予約」を行った状態で再度選択し、「複数選択予約を消去」すると、選択範囲部分の「複数選択予約」が解除されます。</li>
</ul></li>
<li><p>検索を使う方法</p>
<p>「<a href="2_find.html">第II部〜知っていると便利な秀丸の機能　検索</a>」に説明がありますが、 「すべて検索」の所に「<strong>すべて検索 - 複数選択</strong>」があります。</p>
<p>これを使用すれば、検索条件にマッチする箇所をすべて「複数選択」する事が可能です。 この状態から、マウスを使って複数選択を追加する事も出来ます。</p></li>
</ul>
<p>実際に複数選択した状態です。(3箇所を選択している)</p>
<p><img src="2_multiselect_02.png" alt="複数選択の例" width="448" height="231" /><br />
</p>
<p>複数選択した状態で、キー入力を行うと、選択した箇所全てに同じ内容を入力できます。 (通常の範囲選択と同じで、選択した箇所を上書きします。)</p>
<p><img src="2_multiselect_05.png" alt="複数選択して入力" width="430" height="212" /><br />
</p>
<p>複数選択した状態でコピーを行うと、複数選択した項目を改行で連結した文字列としてコピーされます。</p>
<p><img src="2_multiselect_03.png" alt="複数選択してコピー0" width="387" height="213" /><br />
</p>
<p>貼り付け結果</p>
<p><img src="2_multiselect_04.png" alt="複数選択後の貼り付け" width="203" height="90" /><br />
</p>
<p>複数選択後、カーソルキーの[←] or [→] で、カーソル位置を各範囲選択の先頭か末尾に一度だけ移動できます。 選択状態は解除されますが、複数選択中なので、そのまま入力を行うと、先頭 または末尾に追加されていきます。 複数選択が解除されているかどうかは、カーソルが複数あるかどうかで判断できます。</p>
<p>末尾にカーソルを移動し、追加した例</p>
<p><img src="2_multiselect_06.png" alt="複数選択後の貼り付け" width="480" height="229" /><br />
</p>
<h3 id="SUPPLEMENTATION">[補足]</h3>
<ul>
<li><p>マウスで複数選択を使う場合、「動作環境−編集−複数選択」で、ドラッグ時のキー割り当てを変更できます。</p>
<p><img src="2_multiselect_01.png" alt="複数選択のキー割り当" width="440" height="254" /><br />
</p></li>
<li><p>キーボードで複数選択を行う場合、「複数選択予約」、「複数選択予約を選択」、「複数選択予約を消去、 「複数選択予約を全て消去」を何かのキーに割り当てておくと便利です。</p></li>
</ul>
<!-- h4 -->
<div class="marginleft">
<h4 id="SUPPLEMENTATION-1">マクロ関連</h4>
<p>複数選択状態で、マクロを実行する場合は注意が必要です。</p>
<p>デフォルト状態では、各種命令は「複数選択」に対応していません。 たとえば、複数選択状態で <code>&quot;copy&quot;</code>、<code>&quot;delete&quot;</code> を実行しても、複数選択した箇所ではなく、 カーソルのある箇所だけ実行されます。</p>
<p>各種命令を「複数選択」に対応させるには、「<span class="font_red">setcompatiblemode</span>文」を使います。</p>
<p>setcompatiblemode 文のフラグには、</p>
<pre><code>0x00100000 各種の文を複数選択に対応した動作にします。</code></pre>
<p>があるので、このフラグをセットします。</p>
</div>
<!-- h4 -->
</div>
<!-- h3 -->
<hr />
<p><a href="hmindex0.html">目次に戻る</a></p>
</body>
</html>
